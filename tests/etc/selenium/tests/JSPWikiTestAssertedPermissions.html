<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
  <title>JSPWiki Test Asserted Permissions</title>
</head>
<body> 
<table cellpadding="1" cellspacing="1" border="1">
	<tbody>
	<tr><td rowspan="1" colspan="3">JSPWiki Test Asserted Permissions<br></td></tr>
<!--
        // Create new group with 'janne' and 'FredFlintstone' as members
        t.gotoPage( "/Wiki.jsp" );
        login( TEST_LOGINNAME, TEST_PASSWORD );
        String group = "AssertedPermissions" + String.valueOf( System.currentTimeMillis() );
        String members = TEST_LOGINNAME + " \n FredFlintstone";

        // First, create the group
        t.gotoPage( "/NewGroup.jsp" );
        t.assertTextPresent( "Create New Group" );
        t.assertFormPresent( "createGroup" );
        t.setWorkingForm( "createGroup" );
        t.assertFormElementPresent("group" );
        t.assertFormElementPresent("members" );
        t.assertSubmitButtonPresent( "ok" );
        t.setFormElement( "group", group );
        t.setFormElement( "members", members );
        t.submit( "ok" );
        
        // Verify the group was created 
        t.assertTextNotPresent( "Could not create group" );
        t.gotoPage("/Group.jsp?group=" + group );
        t.assertTextPresent( "This is the wiki group called" );
        
        // Verifiy that anonymous users can't view the group
        newSession();
        t.gotoPage("/Group.jsp?group=" + group );
        t.assertTextPresent( "Please sign in" );
        
        // Log in again and verify we can read it
        login( TEST_LOGINNAME, TEST_PASSWORD );
        t.gotoPage("/Group.jsp?group=" + group );
        t.assertTextPresent( "This is the wiki group called" );
        
        // Verify that asserted user 'Fred' can view the group but not edit
        newSession();
        t.gotoPage( "/Wiki.jsp?page=Main" );
        // brushed NOK -- link is hidden in dropdown
        //t.clickLinkWithText( "My Prefs" );
        t.gotoPage( "/UserPreferences.jsp" );
        t.setWorkingForm( "setCookie" );
        t.setFormElement( "assertedName", "FredFlintstone" );
        t.submit( "ok" );
        t.assertTextPresent( "G&#8217;day" );
        t.assertTextPresent( "FredFlintstone" );
        t.assertTextPresent( "(not logged in)" );
        t.gotoPage("/Group.jsp?group=" + group );
        t.assertTextPresent( "This is the wiki group called" );
        
        // Try to edit -- it should not be allowed
        t.gotoPage("/EditGroup.jsp?group=" + group );
        t.assertTextPresent( "Please sign in" );
--!>

	<tr><td>store</td>	<td>/@selenium.context@/Wiki.jsp?page=Main</td>	<td>url</td></tr>
	<tr><td>store</td>	<td>janne</td>	<td>TestUsername</td></tr>
    <tr><td>store</td>	<td>myP@5sw0rd</td>	<td>TestPassword</td></tr>
    <tr><td>open</td>	<td>${url}</td>	<td>&nbsp;</td></tr>

    <tr><td>verifyLocation</td>		<td>*/Wiki.jsp?page=Main</td>	<td>&nbsp;</td></tr>
    <tr><td>verifyTextPresent</td>	<td>glob:G&#8217;day (anonymous guest)</td>	<td>&nbsp;</td></tr>
    <tr><td>verifyTitle</td>		<td>JSPWiki: Main</td>	<td>&nbsp;</td></tr>

    <!-- login --!>
    <tr><td>clickAndWait</td>	<td>link=Log in</td> 	<td>&nbsp;</td></tr>
    <tr><td>verifyTitle</td>	<td>JSPWiki: Login</td>	<td>&nbsp;</td></tr>
    <tr><td>verifyValue</td>	<td>j_username</td>		<td>&nbsp;</td></tr>
    <tr><td>verifyValue</td>	<td>j_password</td>		<td>&nbsp;</td></tr>
    <tr><td>verifyElementPresent</td>	<td>submitlogin</td>	<td></td></tr>

    <tr><td>type</td>	<td>j_username</td>	<td>${TestUsername}</td></tr>
    <tr><td>type</td>	<td>j_password</td>	<td>${TestPassword}</td></tr>

    <tr><td>clickAndWait</td>	<td>submitlogin</td>	<td>&nbsp;</td></tr>

    <tr><td>verifyTitle</td><td>JSPWiki: Main</td><td>&nbsp;</td></tr>
    
	</tbody>
</table>

</body>
</html>
